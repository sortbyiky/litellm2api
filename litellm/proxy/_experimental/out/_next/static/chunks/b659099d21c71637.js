(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,954616,e=>{"use strict";var t=e.i(271645),s=e.i(114272),i=e.i(540143),a=e.i(915823),r=e.i(619273),n=class extends a.Subscribable{#e;#t=void 0;#s;#i;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,r.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,r.hashKey)(t.mutationKey)!==(0,r.hashKey)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#r(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#r()}mutate(e,t){return this.#i=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,s.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#r(e){i.notifyManager.batch(()=>{if(this.#i&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,t,s,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(e.data,null,t,s,i)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,t,s,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(void 0,e.error,t,s,i)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},l=e.i(912598);function o(e,s){let a=(0,l.useQueryClient)(s),[o]=t.useState(()=>new n(a,e));t.useEffect(()=>{o.setOptions(e)},[o,e]);let u=t.useSyncExternalStore(t.useCallback(e=>o.subscribe(i.notifyManager.batchCalls(e)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),c=t.useCallback((e,t)=>{o.mutate(e,t).catch(r.noop)},[o]);if(u.error&&(0,r.shouldThrowError)(o.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:c,mutateAsync:u.mutate}}e.s(["useMutation",()=>o],954616)},992571,e=>{"use strict";var t=e.i(619273);function s(e){return{onFetch:(s,r)=>{let n=s.options,l=s.fetchOptions?.meta?.fetchMore?.direction,o=s.state.data?.pages||[],u=s.state.data?.pageParams||[],c={pages:[],pageParams:[]},d=0,h=async()=>{let r=!1,h=(0,t.ensureQueryFn)(s.options,s.fetchOptions),m=async(e,i,a)=>{let n;if(r)return Promise.reject();if(null==i&&e.pages.length)return Promise.resolve(e);let l=(n={client:s.client,queryKey:s.queryKey,pageParam:i,direction:a?"backward":"forward",meta:s.options.meta},(0,t.addConsumeAwareSignal)(n,()=>s.signal,()=>r=!0),n),o=await h(l),{maxPages:u}=s.options,c=a?t.addToStart:t.addToEnd;return{pages:c(e.pages,o,u),pageParams:c(e.pageParams,i,u)}};if(l&&o.length){let e="backward"===l,t={pages:o,pageParams:u},s=(e?a:i)(n,t);c=await m(t,s,e)}else{let t=e??o.length;do{let e=0===d?u[0]??n.initialPageParam:i(n,c);if(d>0&&null==e)break;c=await m(c,e),d++}while(d<t)}return c};s.options.persister?s.fetchFn=()=>s.options.persister?.(h,{client:s.client,queryKey:s.queryKey,meta:s.options.meta,signal:s.signal},r):s.fetchFn=h}}}function i(e,{pages:t,pageParams:s}){let i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function a(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}function r(e,t){return!!t&&null!=i(e,t)}function n(e,t){return!!t&&!!e.getPreviousPageParam&&null!=a(e,t)}e.s(["hasNextPage",()=>r,"hasPreviousPage",()=>n,"infiniteQueryBehavior",()=>s])},114272,e=>{"use strict";var t=e.i(540143),s=e.i(88587),i=e.i(936553),a=class extends s.Removable{#e;#n;#l;#o;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#l=e.mutationCache,this.#n=[],this.state=e.state||r(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#n.includes(e)||(this.#n.push(e),this.clearGcTimeout(),this.#l.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#n=this.#n.filter(t=>t!==e),this.scheduleGc(),this.#l.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#n.length||("pending"===this.state.status?this.scheduleGc():this.#l.remove(this))}continue(){return this.#o?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#u({type:"continue"})},s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#o=(0,i.createRetryer)({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#u({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#u({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#l.canRun(this)});let a="pending"===this.state.status,r=!this.#o.canStart();try{if(a)t();else{this.#u({type:"pending",variables:e,isPaused:r}),this.#l.config.onMutate&&await this.#l.config.onMutate(e,this,s);let t=await this.options.onMutate?.(e,s);t!==this.state.context&&this.#u({type:"pending",context:t,variables:e,isPaused:r})}let i=await this.#o.start();return await this.#l.config.onSuccess?.(i,e,this.state.context,this,s),await this.options.onSuccess?.(i,e,this.state.context,s),await this.#l.config.onSettled?.(i,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(i,null,e,this.state.context,s),this.#u({type:"success",data:i}),i}catch(t){try{await this.#l.config.onError?.(t,e,this.state.context,this,s)}catch(e){Promise.reject(e)}try{await this.options.onError?.(t,e,this.state.context,s)}catch(e){Promise.reject(e)}try{await this.#l.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,s)}catch(e){Promise.reject(e)}try{await this.options.onSettled?.(void 0,t,e,this.state.context,s)}catch(e){Promise.reject(e)}throw this.#u({type:"error",error:t}),t}finally{this.#l.runNext(this)}}#u(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),t.notifyManager.batch(()=>{this.#n.forEach(t=>{t.onMutationUpdate(e)}),this.#l.notify({mutation:this,type:"updated",action:e})})}};function r(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}e.s(["Mutation",()=>a,"getDefaultState",()=>r])},317751,e=>{"use strict";var t=e.i(619273),s=e.i(286491),i=e.i(540143),a=e.i(915823),r=class extends a.Subscribable{constructor(e={}){super(),this.config=e,this.#c=new Map}#c;build(e,i,a){let r=i.queryKey,n=i.queryHash??(0,t.hashQueryKeyByOptions)(r,i),l=this.get(n);return l||(l=new s.Query({client:e,queryKey:r,queryHash:n,options:e.defaultQueryOptions(i),state:a,defaultOptions:e.getQueryDefaults(r)}),this.add(l)),l}add(e){this.#c.has(e.queryHash)||(this.#c.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){let t=this.#c.get(e.queryHash);t&&(e.destroy(),t===e&&this.#c.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){i.notifyManager.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#c.get(e)}getAll(){return[...this.#c.values()]}find(e){let s={exact:!0,...e};return this.getAll().find(e=>(0,t.matchQuery)(s,e))}findAll(e={}){let s=this.getAll();return Object.keys(e).length>0?s.filter(s=>(0,t.matchQuery)(e,s)):s}notify(e){i.notifyManager.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){i.notifyManager.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){i.notifyManager.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},n=e.i(114272),l=a,o=class extends l.Subscribable{constructor(e={}){super(),this.config=e,this.#d=new Set,this.#h=new Map,this.#m=0}#d;#h;#m;build(e,t,s){let i=new n.Mutation({client:e,mutationCache:this,mutationId:++this.#m,options:e.defaultMutationOptions(t),state:s});return this.add(i),i}add(e){this.#d.add(e);let t=u(e);if("string"==typeof t){let s=this.#h.get(t);s?s.push(e):this.#h.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#d.delete(e)){let t=u(e);if("string"==typeof t){let s=this.#h.get(t);if(s)if(s.length>1){let t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&this.#h.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){let t=u(e);if("string"!=typeof t)return!0;{let s=this.#h.get(t),i=s?.find(e=>"pending"===e.state.status);return!i||i===e}}runNext(e){let t=u(e);if("string"!=typeof t)return Promise.resolve();{let s=this.#h.get(t)?.find(t=>t!==e&&t.state.isPaused);return s?.continue()??Promise.resolve()}}clear(){i.notifyManager.batch(()=>{this.#d.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#d.clear(),this.#h.clear()})}getAll(){return Array.from(this.#d)}find(e){let s={exact:!0,...e};return this.getAll().find(e=>(0,t.matchMutation)(s,e))}findAll(e={}){return this.getAll().filter(s=>(0,t.matchMutation)(e,s))}notify(e){i.notifyManager.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){let e=this.getAll().filter(e=>e.state.isPaused);return i.notifyManager.batch(()=>Promise.all(e.map(e=>e.continue().catch(t.noop))))}};function u(e){return e.options.scope?.id}var c=e.i(175555),d=e.i(814448),h=e.i(992571),m=class{#y;#l;#g;#f;#p;#x;#b;#v;constructor(e={}){this.#y=e.queryCache||new r,this.#l=e.mutationCache||new o,this.#g=e.defaultOptions||{},this.#f=new Map,this.#p=new Map,this.#x=0}mount(){this.#x++,1===this.#x&&(this.#b=c.focusManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#y.onFocus())}),this.#v=d.onlineManager.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#y.onOnline())}))}unmount(){this.#x--,0===this.#x&&(this.#b?.(),this.#b=void 0,this.#v?.(),this.#v=void 0)}isFetching(e){return this.#y.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#l.findAll({...e,status:"pending"}).length}getQueryData(e){let t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state.data}ensureQueryData(e){let s=this.defaultQueryOptions(e),i=this.#y.build(this,s),a=i.state.data;return void 0===a?this.fetchQuery(e):(e.revalidateIfStale&&i.isStaleByTime((0,t.resolveStaleTime)(s.staleTime,i))&&this.prefetchQuery(s),Promise.resolve(a))}getQueriesData(e){return this.#y.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,s,i){let a=this.defaultQueryOptions({queryKey:e}),r=this.#y.get(a.queryHash),n=r?.state.data,l=(0,t.functionalUpdate)(s,n);if(void 0!==l)return this.#y.build(this,a).setData(l,{...i,manual:!0})}setQueriesData(e,t,s){return i.notifyManager.batch(()=>this.#y.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){let t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state}removeQueries(e){let t=this.#y;i.notifyManager.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){let s=this.#y;return i.notifyManager.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,s={}){let a={revert:!0,...s};return Promise.all(i.notifyManager.batch(()=>this.#y.findAll(e).map(e=>e.cancel(a)))).then(t.noop).catch(t.noop)}invalidateQueries(e,t={}){return i.notifyManager.batch(()=>(this.#y.findAll(e).forEach(e=>{e.invalidate()}),e?.refetchType==="none")?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))}refetchQueries(e,s={}){let a={...s,cancelRefetch:s.cancelRefetch??!0};return Promise.all(i.notifyManager.batch(()=>this.#y.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let s=e.fetch(void 0,a);return a.throwOnError||(s=s.catch(t.noop)),"paused"===e.state.fetchStatus?Promise.resolve():s}))).then(t.noop)}fetchQuery(e){let s=this.defaultQueryOptions(e);void 0===s.retry&&(s.retry=!1);let i=this.#y.build(this,s);return i.isStaleByTime((0,t.resolveStaleTime)(s.staleTime,i))?i.fetch(s):Promise.resolve(i.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(t.noop).catch(t.noop)}fetchInfiniteQuery(e){return e.behavior=(0,h.infiniteQueryBehavior)(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(t.noop).catch(t.noop)}ensureInfiniteQueryData(e){return e.behavior=(0,h.infiniteQueryBehavior)(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return d.onlineManager.isOnline()?this.#l.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#y}getMutationCache(){return this.#l}getDefaultOptions(){return this.#g}setDefaultOptions(e){this.#g=e}setQueryDefaults(e,s){this.#f.set((0,t.hashKey)(e),{queryKey:e,defaultOptions:s})}getQueryDefaults(e){let s=[...this.#f.values()],i={};return s.forEach(s=>{(0,t.partialMatchKey)(e,s.queryKey)&&Object.assign(i,s.defaultOptions)}),i}setMutationDefaults(e,s){this.#p.set((0,t.hashKey)(e),{mutationKey:e,defaultOptions:s})}getMutationDefaults(e){let s=[...this.#p.values()],i={};return s.forEach(s=>{(0,t.partialMatchKey)(e,s.mutationKey)&&Object.assign(i,s.defaultOptions)}),i}defaultQueryOptions(e){if(e._defaulted)return e;let s={...this.#g.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return s.queryHash||(s.queryHash=(0,t.hashQueryKeyByOptions)(s.queryKey,s)),void 0===s.refetchOnReconnect&&(s.refetchOnReconnect="always"!==s.networkMode),void 0===s.throwOnError&&(s.throwOnError=!!s.suspense),!s.networkMode&&s.persister&&(s.networkMode="offlineFirst"),s.queryFn===t.skipToken&&(s.enabled=!1),s}defaultMutationOptions(e){return e?._defaulted?e:{...this.#g.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#y.clear(),this.#l.clear()}};e.s(["QueryClient",()=>m],317751)},566606,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(618566),a=e.i(317751),r=e.i(912598),n=e.i(947293),l=e.i(764205),o=e.i(954616),u=e.i(266027),c=e.i(612256);let d=(0,e.i(243652).createQueryKeys)("onboarding");var h=e.i(482725),m=e.i(56456);function y(){return(0,t.jsx)("div",{className:"mx-auto w-full max-w-md mt-10 flex justify-center",children:(0,t.jsx)(h.Spin,{indicator:(0,t.jsx)(m.LoadingOutlined,{spin:!0}),size:"large"})})}var g=e.i(560445),f=e.i(464571);function p(){return(0,t.jsxs)("div",{className:"mx-auto w-full max-w-md mt-10",children:[(0,t.jsx)(g.Alert,{type:"error",message:"Failed to load invitation",description:"The invitation link may be invalid or expired.",showIcon:!0}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(f.Button,{href:"/ui/login",children:"Back to Login"})})]})}var x=e.i(175712),b=e.i(808613),v=e.i(311451),w=e.i(898586);function S({variant:e,userEmail:i,isPending:a,claimError:r,onSubmit:n}){let[l]=b.Form.useForm();return s.default.useEffect(()=>{i&&l.setFieldValue("user_email",i)},[i,l]),(0,t.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,t.jsxs)(x.Card,{children:[(0,t.jsx)(w.Typography.Title,{level:5,className:"text-center mb-5",children:"ðŸš… LiteLLM"}),(0,t.jsx)(w.Typography.Title,{level:3,children:"reset_password"===e?"Reset Password":"Sign Up"}),(0,t.jsx)(w.Typography.Text,{children:"reset_password"===e?"Reset your password to access Admin UI.":"Claim your user account to login to Admin UI."}),"signup"===e&&(0,t.jsx)(g.Alert,{className:"mt-4",type:"info",message:"SSO",description:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"SSO is under the Enterprise Tier."}),(0,t.jsx)(f.Button,{type:"primary",size:"small",href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})]}),showIcon:!0}),(0,t.jsxs)(b.Form,{className:"mt-10 mb-5",layout:"vertical",form:l,onFinish:e=>n({password:e.password}),children:[(0,t.jsx)(b.Form.Item,{label:"Email Address",name:"user_email",children:(0,t.jsx)(v.Input,{type:"email",disabled:!0})}),(0,t.jsx)(b.Form.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"reset_password"===e?"Enter your new password":"Create a password for your account",children:(0,t.jsx)(v.Input.Password,{})}),r&&(0,t.jsx)(g.Alert,{type:"error",message:r,showIcon:!0,className:"mb-4"}),(0,t.jsx)("div",{className:"mt-10",children:(0,t.jsx)(f.Button,{htmlType:"submit",loading:a,children:"reset_password"===e?"Reset Password":"Sign Up"})})]})]})})}function j({variant:e}){let a=(0,i.useSearchParams)().get("invitation_id"),[r,h]=s.default.useState(null),{data:m,isLoading:g,isError:f}=(e=>{let{isLoading:t}=(0,c.useUIConfig)();return(0,u.useQuery)({queryKey:d.detail(e??""),queryFn:async()=>{if(!e)throw Error("inviteId is required");return(0,l.getOnboardingCredentials)(e)},enabled:!!e&&!t})})(a),{mutate:x,isPending:b}=(0,o.useMutation)({mutationFn:async({accessToken:e,inviteId:t,userId:s,password:i})=>await (0,l.claimOnboardingToken)(e,t,s,i)}),v=m?.token?(0,n.jwtDecode)(m.token):null,w=v?.user_email??"",j=v?.user_id??null,k=v?.key??null,C=m?.token??null;return g?(0,t.jsx)(y,{}):f?(0,t.jsx)(p,{}):(0,t.jsx)(S,{variant:e,userEmail:w,isPending:b,claimError:r,onSubmit:e=>{k&&C&&j&&a&&(h(null),x({accessToken:k,inviteId:a,userId:j,password:e.password},{onSuccess:()=>{document.cookie=`token=${C}; path=/; SameSite=Lax`;let e=(0,l.getProxyBaseUrl)();window.location.href=e?`${e}/ui/?login=success`:"/ui/?login=success"},onError:e=>{h(e.message||"Failed to submit. Please try again.")}}))}})}let k=new a.QueryClient;function C(){let e=(0,i.useSearchParams)().get("action");return(0,t.jsx)(j,{variant:"reset_password"===e?"reset_password":"signup"})}function O(){return(0,t.jsx)(r.QueryClientProvider,{client:k,children:(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}),children:(0,t.jsx)(C,{})})})}e.s(["default",()=>O],566606)},700514,e=>{"use strict";var t=e.i(271645);e.s(["defaultPageSize",0,25,"useBaseUrl",0,()=>{let[e,s]=(0,t.useState)("http://localhost:4000");return(0,t.useEffect)(()=>{{let{protocol:e,host:t}=window.location;s(`${e}//${t}`)}},[]),e}])},633627,969550,e=>{"use strict";var t=e.i(764205);let s=async e=>{if(!e)return[];try{let{aliases:s}=await (0,t.keyAliasesCall)(e);return Array.from(new Set((s||[]).filter(Boolean)))}catch(e){return console.error("Error fetching all key aliases:",e),[]}},i=async(e,s)=>{if(!e)return[];try{let i=[],a=1,r=!0;for(;r;){let n=await (0,t.teamListCall)(e,s||null,null);i=[...i,...n],a<n.total_pages?a++:r=!1}return i}catch(e){return console.error("Error fetching all teams:",e),[]}},a=async e=>{if(!e)return[];try{let s=[],i=1,a=!0;for(;a;){let r=await (0,t.organizationListCall)(e);s=[...s,...r],i<r.total_pages?i++:a=!1}return s}catch(e){return console.error("Error fetching all organizations:",e),[]}};e.s(["fetchAllKeyAliases",0,s,"fetchAllOrganizations",0,a,"fetchAllTeams",0,i],633627);var r=e.i(843476),n=e.i(271645);let l=n.forwardRef(function(e,t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))});var o=e.i(464571),u=e.i(311451),c=e.i(199133),d=e.i(374009);e.s(["default",0,({options:e,onApplyFilters:t,onResetFilters:s,initialValues:i={},buttonLabel:a="Filters"})=>{let[h,m]=(0,n.useState)(!1),[y,g]=(0,n.useState)(i),[f,p]=(0,n.useState)({}),[x,b]=(0,n.useState)({}),[v,w]=(0,n.useState)({}),[S,j]=(0,n.useState)({}),k=(0,n.useCallback)((0,d.default)(async(e,t)=>{if(t.isSearchable&&t.searchFn){b(e=>({...e,[t.name]:!0}));try{let s=await t.searchFn(e);p(e=>({...e,[t.name]:s}))}catch(e){console.error("Error searching:",e),p(e=>({...e,[t.name]:[]}))}finally{b(e=>({...e,[t.name]:!1}))}}},300),[]),C=(0,n.useCallback)(async e=>{if(e.isSearchable&&e.searchFn&&!S[e.name]){b(t=>({...t,[e.name]:!0})),j(t=>({...t,[e.name]:!0}));try{let t=await e.searchFn("");p(s=>({...s,[e.name]:t}))}catch(t){console.error("Error loading initial options:",t),p(t=>({...t,[e.name]:[]}))}finally{b(t=>({...t,[e.name]:!1}))}}},[S]);(0,n.useEffect)(()=>{h&&e.forEach(e=>{e.isSearchable&&!S[e.name]&&C(e)})},[h,e,C,S]);let O=(e,s)=>{let i={...y,[e]:s};g(i),t(i)};return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,r.jsx)(o.Button,{icon:(0,r.jsx)(l,{className:"h-4 w-4"}),onClick:()=>m(!h),className:"flex items-center gap-2",children:a}),(0,r.jsx)(o.Button,{onClick:()=>{let t={};e.forEach(e=>{t[e.name]=""}),g(t),s()},children:"Reset Filters"})]}),h&&(0,r.jsx)("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4 mb-6",children:["Team ID","Status","Organization ID","Key Alias","User ID","End User","Error Code","Error Message","Key Hash","Model"].map(t=>{let s,i=e.find(e=>e.label===t||e.name===t);return i?(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-sm text-gray-600",children:i.label||i.name}),i.isSearchable?(0,r.jsx)(c.Select,{showSearch:!0,className:"w-full",placeholder:`Search ${i.label||i.name}...`,value:y[i.name]||void 0,onChange:e=>O(i.name,e),onOpenChange:e=>{e&&i.isSearchable&&!S[i.name]&&C(i)},onSearch:e=>{w(t=>({...t,[i.name]:e})),i.searchFn&&k(e,i)},filterOption:!1,loading:x[i.name],options:f[i.name]||[],allowClear:!0,notFoundContent:x[i.name]?"Loading...":"No results found"}):i.options?(0,r.jsx)(c.Select,{className:"w-full",placeholder:`Select ${i.label||i.name}...`,value:y[i.name]||void 0,onChange:e=>O(i.name,e),allowClear:!0,children:i.options.map(e=>(0,r.jsx)(c.Select.Option,{value:e.value,children:e.label},e.value))}):i.customComponent?(s=i.customComponent,(0,r.jsx)(s,{value:y[i.name]||void 0,onChange:e=>O(i.name,e??""),placeholder:`Select ${i.label||i.name}...`})):(0,r.jsx)(u.Input,{className:"w-full",placeholder:`Enter ${i.label||i.name}...`,value:y[i.name]||"",onChange:e=>O(i.name,e.target.value),allowClear:!0})]},i.name):null})})]})}],969550)},693569,e=>{"use strict";var t=e.i(843476),s=e.i(268004),i=e.i(309426),a=e.i(350967),r=e.i(898586),n=e.i(947293),l=e.i(618566),o=e.i(271645);e.i(785269);var u=e.i(322831),c=e.i(566606),d=e.i(584578),h=e.i(764205),m=e.i(702597),y=e.i(207082),g=e.i(500330),f=e.i(871943),p=e.i(502547),x=e.i(360820),b=e.i(94629),v=e.i(152990),w=e.i(682830),S=e.i(389083),j=e.i(994388),k=e.i(752978),C=e.i(269200),O=e.i(942232),_=e.i(977572),M=e.i(427612),N=e.i(64848),P=e.i(496020),D=e.i(599724),I=e.i(827252),z=e.i(282786),A=e.i(981339),T=e.i(592968),E=e.i(355619),R=e.i(266027),K=e.i(633627),q=e.i(374009),F=e.i(700514),Q=e.i(135214),B=e.i(969550),L=e.i(20147);function $({teams:e,organizations:s,onSortChange:i,currentSort:a}){let{t:r}=(0,u.useTranslation)(),[n,l]=(0,o.useState)(null),[c,d]=o.default.useState(()=>a?[{id:a.sortBy,desc:"desc"===a.sortOrder}]:[{id:"created_at",desc:!0}]),[m,$]=o.default.useState({pageIndex:0,pageSize:50}),U=c.length>0?c[0].id:null,V=c.length>0?c[0].desc?"desc":"asc":null,{data:H,isPending:J,isFetching:W,refetch:G}=(0,y.useKeys)(m.pageIndex+1,m.pageSize,{sortBy:U||void 0,sortOrder:V||void 0}),Z=H?.total_count||0,[X,Y]=(0,o.useState)({}),{filters:ee,filteredKeys:et,allKeyAliases:es,allTeams:ei,allOrganizations:ea,handleFilterChange:er,handleFilterReset:en}=function({keys:e,teams:t,organizations:s}){let i={"Team ID":"","Organization ID":"","Key Alias":"","User ID":"","Sort By":"created_at","Sort Order":"desc"},{accessToken:a}=(0,Q.default)(),[r,n]=(0,o.useState)(i),[l,u]=(0,o.useState)(t||[]),[c,d]=(0,o.useState)(s||[]),[m,y]=(0,o.useState)(e),g=(0,o.useRef)(0),f=(0,o.useCallback)((0,q.default)(async e=>{if(!a)return;let t=Date.now();g.current=t;try{let s=await (0,h.keyListCall)(a,e["Organization ID"]||null,e["Team ID"]||null,e["Key Alias"]||null,e["User ID"]||null,e["Key Hash"]||null,1,F.defaultPageSize,e["Sort By"]||null,e["Sort Order"]||null);t===g.current&&s&&(y(s.keys),console.log("called from debouncedSearch filters:",JSON.stringify(e)),console.log("called from debouncedSearch data:",JSON.stringify(s)))}catch(e){console.error("Error searching users:",e)}},300),[a]);(0,o.useEffect)(()=>{if(!e)return void y([]);let t=[...e];r["Team ID"]&&(t=t.filter(e=>e.team_id===r["Team ID"])),r["Organization ID"]&&(t=t.filter(e=>e.organization_id===r["Organization ID"])),y(t)},[e,r]),(0,o.useEffect)(()=>{let e=async()=>{let e=await (0,K.fetchAllTeams)(a);e.length>0&&u(e);let t=await (0,K.fetchAllOrganizations)(a);t.length>0&&d(t)};a&&e()},[a]);let p=(0,R.useQuery)({queryKey:["allKeys"],queryFn:async()=>{if(!a)throw Error("Access token required");return await (0,K.fetchAllKeyAliases)(a)},enabled:!!a}).data||[];return(0,o.useEffect)(()=>{t&&t.length>0&&u(e=>e.length<t.length?t:e)},[t]),(0,o.useEffect)(()=>{s&&s.length>0&&d(e=>e.length<s.length?s:e)},[s]),{filters:r,filteredKeys:m,allKeyAliases:p,allTeams:l,allOrganizations:c,handleFilterChange:(e,t=!1)=>{n({"Team ID":e["Team ID"]||"","Organization ID":e["Organization ID"]||"","Key Alias":e["Key Alias"]||"","User ID":e["User ID"]||"","Sort By":e["Sort By"]||"created_at","Sort Order":e["Sort Order"]||"desc"}),t||f({...r,...e})},handleFilterReset:()=>{n(i),f(i)}}}({keys:H?.keys||[],teams:e,organizations:s});(0,o.useEffect)(()=>{if(G){let e=()=>{G()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[G]);let el=(0,o.useMemo)(()=>[{id:"expander",header:()=>null,size:40,enableSorting:!1,cell:({row:e})=>e.getCanExpand()?(0,t.jsx)("button",{onClick:e.getToggleExpandedHandler(),style:{cursor:"pointer"},children:e.getIsExpanded()?"â–¼":"â–¶"}):null},{id:"token",accessorKey:"token",header:r("keys.keyId"),size:100,enableSorting:!0,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:s,children:(0,t.jsx)(j.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate block",style:{maxWidth:i,overflow:"hidden"},onClick:()=>l(e.row.original),children:s??"-"})})}},{id:"key_alias",accessorKey:"key_alias",header:r("keys.keyAlias"),size:150,enableSorting:!0,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:s,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:i,overflow:"hidden"},children:s??"-"})})}},{id:"key_name",accessorKey:"key_name",header:r("keys.secretKey"),size:120,enableSorting:!1,cell:e=>(0,t.jsx)("span",{className:"font-mono text-xs",children:e.getValue()})},{id:"team_alias",accessorKey:"team_id",header:r("keys.teamAlias"),size:120,enableSorting:!1,cell:({row:t,getValue:s})=>{let i=s(),a=e?.find(e=>e.team_id===i);return a?.team_alias||r("keys.unknown")}},{id:"team_id",accessorKey:"team_id",header:r("keys.teamId"),size:80,enableSorting:!1,cell:e=>{let s=e.getValue(),i=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:s,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:i,overflow:"hidden"},children:s??"-"})})}},{id:"organization_id",accessorKey:"organization_id",header:r("keys.organizationId"),size:140,enableSorting:!1,cell:e=>e.getValue()?e.renderValue():"-"},{id:"user_email",accessorKey:"user",header:r("keys.userEmail"),size:160,enableSorting:!1,cell:e=>{let s=e.getValue(),i=s?.user_email,a=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"user_id",accessorKey:"user_id",header:r("keys.userId"),size:70,enableSorting:!1,cell:e=>{let s=e.getValue(),i="default_user_id"===s?r("keys.defaultProxyAdmin"):s,a=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"created_at",accessorKey:"created_at",header:r("keys.createdAt"),size:120,enableSorting:!0,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():"-"}},{id:"created_by",accessorKey:"created_by",header:r("keys.createdBy"),size:70,enableSorting:!1,cell:e=>{let s=e.getValue(),i="default_user_id"===s?r("keys.defaultProxyAdmin"):s,a=e.cell.column.getSize();return(0,t.jsx)(T.Tooltip,{title:i,children:(0,t.jsx)("span",{className:"font-mono text-xs truncate block",style:{maxWidth:a,overflow:"hidden"},children:i??"-"})})}},{id:"updated_at",accessorKey:"updated_at",header:r("keys.updatedAt"),size:120,enableSorting:!0,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():r("keys.never")}},{id:"last_active",accessorKey:"last_active",header:()=>(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[r("keys.lastActive"),(0,t.jsx)(z.Popover,{content:r("keys.lastActiveTooltip"),trigger:"hover",children:(0,t.jsx)(I.InfoCircleOutlined,{className:"text-gray-400 text-xs cursor-help"})})]}),size:130,enableSorting:!1,cell:e=>{let s=e.getValue();if(!s)return r("keys.unknown");let i=new Date(s);return(0,t.jsx)(T.Tooltip,{title:i.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"long"}),children:(0,t.jsx)("span",{children:i.toLocaleDateString()})})}},{id:"expires",accessorKey:"expires",header:r("keys.expires"),size:120,enableSorting:!1,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleDateString():r("keys.never")}},{id:"spend",accessorKey:"spend",header:r("keys.spendUsd"),size:100,enableSorting:!0,cell:e=>(0,g.formatNumberWithCommas)(e.getValue(),4)},{id:"max_budget",accessorKey:"max_budget",header:r("keys.budgetUsd"),size:110,enableSorting:!0,cell:e=>{let t=e.getValue();return null===t?r("keys.unlimited"):`$${(0,g.formatNumberWithCommas)(t)}`}},{id:"budget_reset_at",accessorKey:"budget_reset_at",header:r("keys.budgetReset"),size:130,enableSorting:!1,cell:e=>{let t=e.getValue();return t?new Date(t).toLocaleString():r("keys.never")}},{id:"models",accessorKey:"models",header:r("keys.models"),size:200,enableSorting:!1,cell:e=>{let s=e.getValue();return(0,t.jsx)("div",{className:"flex flex-col py-2",children:Array.isArray(s)?(0,t.jsx)("div",{className:"flex flex-col",children:0===s.length?(0,t.jsx)(S.Badge,{size:"xs",className:"mb-1",color:"red",children:(0,t.jsx)(D.Text,{children:r("keys.allProxyModels")})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex items-start",children:[s.length>3&&(0,t.jsx)("div",{children:(0,t.jsx)(k.Icon,{icon:X[e.row.id]?f.ChevronDownIcon:p.ChevronRightIcon,className:"cursor-pointer",size:"xs",onClick:()=>{Y(t=>({...t,[e.row.id]:!t[e.row.id]}))}})}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(S.Badge,{size:"xs",color:"red",children:(0,t.jsx)(D.Text,{children:r("keys.allProxyModels")})},s):(0,t.jsx)(S.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(D.Text,{children:e.length>30?`${(0,E.getModelDisplayName)(e).slice(0,30)}...`:(0,E.getModelDisplayName)(e)})},s)),s.length>3&&!X[e.row.id]&&(0,t.jsx)(S.Badge,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,t.jsxs)(D.Text,{children:["+",s.length-3," ",s.length-3==1?r("keys.moreModel"):r("keys.moreModels")]})}),X[e.row.id]&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:s.slice(3).map((e,s)=>"all-proxy-models"===e?(0,t.jsx)(S.Badge,{size:"xs",color:"red",children:(0,t.jsx)(D.Text,{children:r("keys.allProxyModels")})},s+3):(0,t.jsx)(S.Badge,{size:"xs",color:"blue",children:(0,t.jsx)(D.Text,{children:e.length>30?`${(0,E.getModelDisplayName)(e).slice(0,30)}...`:(0,E.getModelDisplayName)(e)})},s+3))})]})]})})}):null})}},{id:"rate_limits",header:r("keys.rateLimits"),size:140,enableSorting:!1,cell:({row:e})=>{let s=e.original;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:["TPM: ",null!==s.tpm_limit?s.tpm_limit:r("keys.unlimited")]}),(0,t.jsxs)("div",{children:["RPM: ",null!==s.rpm_limit?s.rpm_limit:r("keys.unlimited")]})]})}}],[]),eo=[{name:r("keys.teamIdFilter"),label:r("keys.teamIdFilter"),isSearchable:!0,searchFn:async e=>ei&&0!==ei.length?ei.filter(t=>t.team_id.toLowerCase().includes(e.toLowerCase())||t.team_alias&&t.team_alias.toLowerCase().includes(e.toLowerCase())).map(e=>({label:`${e.team_alias||e.team_id} (${e.team_id})`,value:e.team_id})):[]},{name:r("keys.organizationIdFilter"),label:r("keys.organizationIdFilter"),isSearchable:!0,searchFn:async e=>ea&&0!==ea.length?ea.filter(t=>t.organization_id?.toLowerCase().includes(e.toLowerCase())??!1).filter(e=>null!==e.organization_id&&void 0!==e.organization_id).map(e=>({label:`${e.organization_id||"Unknown"} (${e.organization_id})`,value:e.organization_id})):[]},{name:r("keys.keyAliasFilter"),label:r("keys.keyAliasFilter"),isSearchable:!0,searchFn:async e=>es.filter(t=>t.toLowerCase().includes(e.toLowerCase())).map(e=>({label:e,value:e}))},{name:r("keys.userIdFilter"),label:r("keys.userIdFilter"),isSearchable:!1},{name:r("keys.keyHashFilter"),label:r("keys.keyHashFilter"),isSearchable:!1}];console.log(`keys: ${JSON.stringify(H)}`);let eu=(0,v.useReactTable)({data:et,columns:el.filter(e=>"expander"!==e.id),columnResizeMode:"onChange",columnResizeDirection:"ltr",state:{sorting:c,pagination:m},onSortingChange:e=>{let t="function"==typeof e?e(c):e;if(console.log(`newSorting: ${JSON.stringify(t)}`),d(t),t&&t.length>0){let e=t[0],s=e.id,a=e.desc?"desc":"asc";console.log(`sortBy: ${s}, sortOrder: ${a}`),er({...ee,"Sort By":s,"Sort Order":a},!0),i?.(s,a)}},onPaginationChange:$,getCoreRowModel:(0,w.getCoreRowModel)(),getSortedRowModel:(0,w.getSortedRowModel)(),getPaginationRowModel:(0,w.getPaginationRowModel)(),enableSorting:!0,manualSorting:!1,manualPagination:!0,pageCount:Math.ceil(Z/m.pageSize)});o.default.useEffect(()=>{a&&d([{id:a.sortBy,desc:"desc"===a.sortOrder}])},[a]);let{pageIndex:ec,pageSize:ed}=eu.getState().pagination,eh=Math.min((ec+1)*ed,Z),em=`${ec*ed+1} - ${eh}`;return(0,t.jsx)("div",{className:"w-full h-full overflow-hidden",children:n?(0,t.jsx)(L.default,{keyId:n.token,onClose:()=>l(null),keyData:n,teams:ei,onDelete:G}):(0,t.jsxs)("div",{className:"border-b py-4 flex-1 overflow-hidden",children:[(0,t.jsx)("div",{className:"w-full mb-6",children:(0,t.jsx)(B.default,{options:eo,onApplyFilters:er,initialValues:ee,onResetFilters:en})}),(0,t.jsxs)("div",{className:"flex items-center justify-between w-full mb-4",children:[J||W?(0,t.jsx)(A.Skeleton.Node,{active:!0,style:{width:200,height:20}}):(0,t.jsx)("span",{className:"inline-flex text-sm text-gray-700",children:r("keys.showingResults",{range:em,total:Z})}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-2",children:[J||W?(0,t.jsx)(A.Skeleton.Node,{active:!0,style:{width:74,height:20}}):(0,t.jsx)("span",{className:"text-sm text-gray-700",children:r("keys.page",{current:ec+1,total:eu.getPageCount()})}),J||W?(0,t.jsx)(A.Skeleton.Button,{active:!0,size:"small",style:{width:84,height:30}}):(0,t.jsx)("button",{onClick:()=>eu.previousPage(),disabled:J||W||!eu.getCanPreviousPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r("keys.previous")}),J||W?(0,t.jsx)(A.Skeleton.Button,{active:!0,size:"small",style:{width:58,height:30}}):(0,t.jsx)("button",{onClick:()=>eu.nextPage(),disabled:J||W||!eu.getCanNextPage(),className:"px-3 py-1 text-sm border rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r("keys.next")})]})]}),(0,t.jsx)("div",{className:"h-[75vh] overflow-auto",children:(0,t.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(C.Table,{className:"[&_td]:py-0.5 [&_th]:py-1",style:{width:eu.getCenterTotalSize()},children:[(0,t.jsx)(M.TableHead,{children:eu.getHeaderGroups().map(e=>(0,t.jsx)(P.TableRow,{children:e.headers.map(e=>(0,t.jsx)(N.TableHeaderCell,{"data-header-id":e.id,className:`py-1 h-8 relative hover:bg-gray-50 ${"actions"===e.id?"sticky right-0 bg-white shadow-[-4px_0_8px_-6px_rgba(0,0,0,0.1)]":""}`,style:{width:e.getSize(),position:"relative",cursor:e.column.getCanSort()?"pointer":"default"},onMouseEnter:()=>{let t=document.querySelector(`[data-header-id="${e.id}"] .resizer`);t&&(t.style.opacity="0.5")},onMouseLeave:()=>{let t=document.querySelector(`[data-header-id="${e.id}"] .resizer`);t&&!e.column.getIsResizing()&&(t.style.opacity="0")},onClick:e.column.getCanSort()?e.column.getToggleSortingHandler():void 0,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,v.flexRender)(e.column.columnDef.header,e.getContext())}),"actions"!==e.id&&e.column.getCanSort()&&(0,t.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,t.jsx)(x.ChevronUpIcon,{className:"h-4 w-4 text-blue-500"}),desc:(0,t.jsx)(f.ChevronDownIcon,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,t.jsx)(b.SwitchVerticalIcon,{className:"h-4 w-4 text-gray-400"})}),(0,t.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:e.getResizeHandler(),onTouchStart:e.getResizeHandler(),className:`resizer ${eu.options.columnResizeDirection} ${e.column.getIsResizing()?"isResizing":""}`,style:{position:"absolute",right:0,top:0,height:"100%",width:"5px",background:e.column.getIsResizing()?"#3b82f6":"transparent",cursor:"col-resize",userSelect:"none",touchAction:"none",opacity:+!!e.column.getIsResizing()}})]})},e.id))},e.id))}),(0,t.jsx)(O.TableBody,{children:J||W?(0,t.jsx)(P.TableRow,{children:(0,t.jsx)(_.TableCell,{colSpan:el.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsxs)("p",{children:["ðŸš… ",r("keys.loadingKeys")]})})})}):et.length>0?eu.getRowModel().rows.map(e=>(0,t.jsx)(P.TableRow,{className:"h-8",children:e.getVisibleCells().map(e=>(0,t.jsx)(_.TableCell,{style:{width:e.column.getSize(),maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:`py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap ${"models"===e.column.id&&Array.isArray(e.getValue())&&e.getValue().length>3?"px-0":""}`,children:(0,v.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(P.TableRow,{children:(0,t.jsx)(_.TableCell,{colSpan:el.length,className:"h-8 text-center",children:(0,t.jsx)("div",{className:"text-center text-gray-500",children:(0,t.jsx)("p",{children:r("keys.noKeysFound")})})})})})]})})})})]})})}e.s(["default",0,({userID:e,userRole:y,teams:g,keys:f,setUserRole:p,userEmail:x,setUserEmail:b,setTeams:v,setKeys:w,premiumUser:S,organizations:j,addKey:k,createClicked:C})=>{let O,[_,M]=(0,o.useState)(null),[N,P]=(0,o.useState)(null),D=(0,l.useSearchParams)(),I=(console.log("COOKIES",document.cookie),(O=document.cookie.split("; ").find(e=>e.startsWith("token=")))?O.split("=")[1]:null),z=D.get("invitation_id"),[A,T]=(0,o.useState)(null),[E,R]=(0,o.useState)(null),[K,q]=(0,o.useState)([]),{t:F}=(0,u.useTranslation)(),[Q,B]=(0,o.useState)(null),[L,U]=(0,o.useState)(null);if(window.addEventListener("beforeunload",function(){sessionStorage.clear()}),(0,o.useEffect)(()=>{if(I){let e=(0,n.jwtDecode)(I);if(e){if(console.log("Decoded token:",e),console.log("Decoded key:",e.key),T(e.key),e.user_role){let t=function(e){if(!e)return"Undefined Role";switch(console.log(`Received user role: ${e}`),e.toLowerCase()){case"app_owner":case"demo_app_owner":return"App Owner";case"app_admin":case"proxy_admin":return"Admin";case"proxy_admin_viewer":return"Admin Viewer";case"app_user":return"App User";case"internal_user":return"Internal User";case"internal_user_viewer":return"Internal Viewer";default:return"Unknown Role"}}(e.user_role);console.log("Decoded user_role:",t),p(t)}else console.log("User role not defined");e.user_email?b(e.user_email):console.log(`User Email is not set ${e}`)}}if(e&&A&&y&&!f&&!_){let t=sessionStorage.getItem("userModels"+e);t?q(JSON.parse(t)):(console.log(`currentOrg: ${JSON.stringify(N)}`),(async()=>{try{let t=await (0,h.getProxyUISettings)(A);B(t);let s=await (0,h.userInfoCall)(A,e,y,!1,null,null);M(s.user_info),console.log(`userSpendData: ${JSON.stringify(_)}`),s?.teams[0].keys?w(s.keys.concat(s.teams.filter(t=>"Admin"===y||t.user_id===e).flatMap(e=>e.keys))):w(s.keys),sessionStorage.setItem("userData"+e,JSON.stringify(s.keys)),sessionStorage.setItem("userSpendData"+e,JSON.stringify(s.user_info));let i=(await (0,h.modelAvailableCall)(A,e,y)).data.map(e=>e.id);console.log("available_model_names:",i),q(i),console.log("userModels:",K),sessionStorage.setItem("userModels"+e,JSON.stringify(i))}catch(e){console.error("There was an error fetching the data",e),e.message.includes("Invalid proxy server token passed")&&V()}})(),(0,d.fetchTeams)(A,e,y,N,v))}},[e,I,A,f,y]),(0,o.useEffect)(()=>{A&&(async()=>{try{let e=await (0,h.keyInfoCall)(A,[A]);console.log("keyInfo: ",e)}catch(e){e.message.includes("Invalid proxy server token passed")&&V()}})()},[A]),(0,o.useEffect)(()=>{console.log(`currentOrg: ${JSON.stringify(N)}, accessToken: ${A}, userID: ${e}, userRole: ${y}`),A&&(console.log("fetching teams"),(0,d.fetchTeams)(A,e,y,N,v))},[N]),(0,o.useEffect)(()=>{if(null!==f&&null!=L&&null!==L.team_id){let e=0;for(let t of(console.log(`keys: ${JSON.stringify(f)}`),f))L.hasOwnProperty("team_id")&&null!==t.team_id&&t.team_id===L.team_id&&(e+=t.spend);console.log(`sum: ${e}`),R(e)}else if(null!==f){let e=0;for(let t of f)e+=t.spend;R(e)}},[L]),null!=z)return(0,t.jsx)(c.default,{});function V(){(0,s.clearTokenCookies)();let e=(0,h.getProxyBaseUrl)();console.log("proxyBaseUrl:",e);let t=e?`${e}/sso/key/generate`:"/sso/key/generate";return console.log("Full URL:",t),window.location.href=t,null}if(null==I)return console.log("All cookies before redirect:",document.cookie),V(),null;try{let e=(0,n.jwtDecode)(I);console.log("Decoded token:",e);let t=e.exp,s=Math.floor(Date.now()/1e3);if(t&&s>=t)return console.log("Token expired, redirecting to login"),V(),null}catch(e){return console.error("Error decoding token:",e),(0,s.clearTokenCookies)(),V(),null}if(null==A)return null;if(null==e)return(0,t.jsx)("h1",{children:F("dashboard.userIdNotSet")});if(null==y&&p("App Owner"),y&&"Admin Viewer"==y){let{Title:e,Paragraph:s}=r.Typography;return(0,t.jsxs)("div",{children:[(0,t.jsx)(e,{level:1,children:F("dashboard.accessDenied")}),(0,t.jsx)(s,{children:F("dashboard.askAdminForAccess")})]})}return console.log("inside user dashboard, selected team",L),console.log("All cookies after redirect:",document.cookie),(0,t.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,t.jsx)(a.Grid,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,t.jsxs)(i.Col,{numColSpan:1,className:"flex flex-col gap-2",children:[(0,t.jsx)(m.default,{team:L,teams:g,data:f,addKey:k},L?L.team_id:null),(0,t.jsx)($,{teams:g,organizations:j})]})})})}],693569)}]);